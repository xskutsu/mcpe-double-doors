import{Block,GameMode,world}from"@minecraft/server";let MinecraftDoors=["minecraft:acacia_door","minecraft:bamboo_door","minecraft:birch_door","minecraft:cherry_door","minecraft:copper_door","minecraft:crimson_door","minecraft:dark_oak_door","minecraft:exposed_copper_door","minecraft:jungle_door","minecraft:mangrove_door","minecraft:oxidized_copper_door","minecraft:spruce_door","minecraft:warped_door","minecraft:waxed_copper_door","minecraft:waxed_exposed_copper_door","minecraft:waxed_oxidized_copper_door","minecraft:waxed_weathered_copper_door","minecraft:weathered_copper_door","minecraft:wooden_door"];function getBlockFromDoorLowerPartDirection(e){var o=e.above().permutation.getState("door_hinge_bit");switch(e.permutation.getState("direction")){case 0:return o?e.north():e.south();case 1:return o?e.east():e.west();case 2:return o?e.south():e.north();case 3:return o?e.west():e.east()}}world.afterEvents.playerInteractWithBlock.subscribe(function(e){var o;e.player.isSneaking||MinecraftDoors.includes(e.block.typeId)&&(o=getBlockFromDoorLowerPartDirection(e=e.block.permutation.getState("upper_block_bit")?e.block.below():e.block),MinecraftDoors.includes(o.typeId))&&!o.permutation.getState("upper_block_bit")&&o.setPermutation(o.permutation.withState("open_bit",e.permutation.getState("open_bit")))}),world.afterEvents.itemUseOn.subscribe(function(e){if(e.source.getGameMode()!==GameMode.adventure&&"minecraft:redstone_torch"===e.itemStack.typeId)switch(e.block.typeId){case"minecraft:iron_door":var o=e.block.permutation.getState("upper_block_bit")?e.block.below():e.block,t=!o.permutation.getState("open_bit");o.setPermutation(o.permutation.withState("open_bit",t)),e.block.dimension.playSound(t?"open.iron_door":"close.iron_door",e.block);break;case"minecraft:iron_trapdoor":o=!e.block.permutation.getState("open_bit");e.block.setPermutation(e.block.permutation.withState("open_bit",o)),e.block.dimension.playSound(o?"open.iron_trapdoor":"close.iron_trapdoor",e.block)}});